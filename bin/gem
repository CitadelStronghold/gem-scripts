#!/bin/bash

MODE="$1"
TARGET="$2"

EDITOR="${EDITOR:-helix}"

if [[ "$1" = "" ]]; then
    sudo bash /opt/gem/update.sh || exit 1
    exit 0
fi

if [[ "$1" = "install" ]]; then
    sudo bash /opt/gem/install.sh $TARGET || exit 1
    exit 0
fi

if [[ "$1" = "pac" ]]; then
    sudo bash /opt/gem/pac.sh "${@:2}" || exit 1
    exit 0
fi

if [[ "$1" = "tree" ]]; then
    echo "[gem] [tree]"
    tree /opt/gem/gems || exit 1
    exit 0
fi

if [[ "$1" = "shutdown" ]]; then
    sudo shutdown -h --no-wall now
    exit 0
fi
if [[ "$1" = "reboot" ]]; then
    sudo reboot -h --no-wall
    exit 0
fi

if [[ "$1" = "c" ]]; then
    if [[ "$2" = "hypr" || "$2" = "hyprland" ]]; then
        $EDITOR ~/.config/hypr/hyprland.conf
    elif [[ "$2" = "paper" ]]; then
        $EDITOR ~/.config/hypr/hyprpaper.conf
    elif [[ "$2" = "foot" ]]; then
        $EDITOR ~/.config/foot/foot.ini
    elif [[ "$2" = "rofi" ]]; then
        $EDITOR ~/.config/rofi/config.rasi
    elif [[ "$2" = "rofimoji" ]]; then
        $EDITOR ~/.config/rofimoji.rc
    elif [[ "$2" = "init" ]]; then
        (sudo $EDITOR /etc/mkinitcpio.conf) && (sudo mkinitcpio -P)
    fi

    exit 0
fi

bash /opt/gem/gems/$TARGET $MODE || exit 1